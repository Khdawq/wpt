<!DOCTYPE HTML>
<script src="/resources/testharness.js"></script>
<script src="/resources/testharnessreport.js"></script>
<script src="/common/utils.js"></script>
<script src="/common/dispatcher/dispatcher.js"></script>
<script src="../resources/helper.sub.js"></script>
<script>
// Needs check_eligibility_after_pagehide
// {BackForwardCacheMetrics::NotRestoredReason::kBlocklistedFeatures},
// {blink::scheduler::WebSchedulerTrackedFeature::kBroadcastChannel}
runEventTest(
  url => window.open(url, '_blank', 'noopener'),
  () => {
    window.bc = new BroadcastChannel('foo');
    window.addEventListener('pagehide', () => window.bc.close());
  },
  originCrossSite,
  [], [], 'Eligibility (BroadcastChannel closed in pagehide event)');
</script>
